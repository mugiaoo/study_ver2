<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>RFIDタグ登録</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 2em; }
        input, select { margin-bottom: 1em; width: 300px; padding: 0.5em; }
        table { border-collapse: collapse; margin-top: 2em; width: 100%; }
        th, td { border: 1px solid #ccc; padding: 0.5em; text-align: left; }
        th { background: #f2f2f2; }
    </style>
</head>
<body>
    <h1>RFID タグ登録</h1>
    
    {% if message %}
        <p><strong>{{ message }}</strong></p>
    {% endif %}

    <form method="POST" action="/register-ui">
        <!-- フルIDを貼る前提に変更 -->
        <label for="tag_id">タグID（リーダで読み取った文字列をそのまま貼り付け）:</label><br>
        <input type="text" id="tag_id" name="tag_id" required><br>
        <small>※ システム内部では末尾5文字のみを使用して識別します。</small><br><br>

        <label for="name">名前:</label><br>
        <input type="text" id="name" name="name" required><br>

        <label for="category">カテゴリ:</label><br>
        <input type="text" id="category" name="category" required><br>

        <button type="submit">登録</button>
    </form>

    <h2>登録済みタグ一覧</h2>
    <table>
        <thead>
            <tr>
                <th>タグID（末尾5桁）</th>
                <th>名前</th>
                <th>カテゴリ</th>
                <th>操作</th> 
            </tr>
        </thead>
        <tbody>
            {% for tag in tags %}
            <tr>
                <!-- server.py 側で SELECT tag_id, name, category, created_at -->
                <td>{{ tag[0] }}</td>  <!-- 末尾5桁 -->
                <td>{{ tag[1] }}</td>  <!-- name -->
                <td>{{ tag[2] }}</td>  <!-- category -->
                <td style="white-space: nowrap; width: 100px;">
                    <form method="POST" action="/edit" style="display:inline;">
                        <input type="hidden" name="tag_id" value="{{ tag[0] }}">
                        <button type="submit" style="padding: 2px 6px; font-size: 12px;">編集</button>
                    </form>
                    <form method="POST" action="/delete" style="display:inline;" onsubmit="return confirm('本当に削除しますか？');">
                        <input type="hidden" name="tag_id" value="{{ tag[0] }}">
                        <button type="submit" style="padding: 2px 6px; font-size: 12px;">削除</button>
                    </form>
                </td>
            </tr>
            {% else %}
            <tr><td colspan="4">まだタグは登録されていません。</td></tr>
            {% endfor %}
        </tbody>
    </table>
</body>
</html>
